// sexy-args 1.1.4 Benjamin Coe.
(function(){function a(){this.DEFAULTS_BY_TYPE={"function":function(){return(function(){})},object:function(){return{}},array:function(){return[]}}}a.prototype.run=function(b){this._extend(this,b);this.originalFunction=this.originalArguments.callee;if(this.originalFunction.___complete){this._executeCallback()}else{this._performParse();this._reinvokeOriginalFunction()}};a.prototype._executeCallback=function(){delete this.originalFunction.___complete;this.callback.apply(this.originalContext,this.originalArguments)};a.prototype._performParse=function(){this._createArgumentsToApplyObject();this._createArgumentsStack();this._and(this.argumentDescriptions)};a.prototype._reinvokeOriginalFunction=function(){this.originalFunction.___complete=true;var c=[],b;for(var d in this.argumentsToApply){if(this.argumentsToApply.hasOwnProperty(d)){b=this.argumentsToApply[d];c[b.index]=b.value}}this.originalFunction.apply(this.originalContext,c)};a.prototype._createArgumentsToApplyObject=function(){var f=this;this.argumentsToApply={};function b(g,h){for(var j=0,k;(k=g[j])!=null;j++){e(k,h)}}function e(i,g){var h={index:g,value:f._getDefaultValue(i)};f.argumentsToApply[i]=h}for(var c=0,d;(d=this.argumentDescriptions[c])!=null;c++){if(Array.isArray(d)){b(d,c)}else{e(d,c)}}};a.prototype._getDefaultValue=function(b){if(this.defaults[b]){return this.defaults[b]}var c=this.DEFAULTS_BY_TYPE[b.slice(0,-1)];if(typeof(c)==="function"){return c()}return undefined};a.prototype._createArgumentsStack=function(){this.argumentsStack=[];for(var b=0;b<this.originalArguments.length;b++){this.argumentsStack.push(this.originalArguments[b])}};a.prototype._and=function(b){for(var c=0,e;(e=b[c])!=null;c++){if(!this.argumentsStack.length){return}var d=this.argumentsStack.shift();if(Array.isArray(e)){this._or(e,d,c)}else{this._argument(e,d,c)}}this._populateAdditionalArguments(c)};a.prototype._populateAdditionalArguments=function(b){for(var c=0;c<this.argumentsStack.length;c++){this.argumentsToApply["_"+c]={value:this.argumentsStack[c],index:c+b}}};a.prototype._or=function(b,g,c){for(var d=0,f;(f=b[d])!=null;d++){var e=f.slice(0,-1);if(typeof(g)===e){this._setArgumentValue(f,g,e);return}}this._throwError("'or' statement failed to evaluate.",c)};a.prototype._argument=function(e,d,b){var c=e.slice(0,-1);if(this._typeof(d)!==c){this._throwError("typeof("+e+") should be '"+c+"' was "+typeof(d),b)}if(d){this._setArgumentValue(e,d,c)}};a.prototype._setArgumentValue=function(b,d,c){if(c==="object"){this._extend(d,this.argumentsToApply[b].value,true);this.argumentsToApply[b].value=d}else{this.argumentsToApply[b].value=d}};a.prototype._throwError=function(c,b){throw new Error("sexy-args.Parser: could not parse argument "+b+". "+c)};a.prototype._typeof=function(b){if(Array.isArray(b)){return"array"}return typeof(b)};a.prototype._extend=function(e,c,d){for(var b in c){if(c.hasOwnProperty(b)){if(!d||typeof e[b]=="undefined"){e[b]=c[b]}}}};if(typeof(exports)==="undefined"){if(typeof(sexy)==="undefined"){sexy={}}sexy.Parser=a}else{exports.Parser=a}})();(function(){if(typeof(sexy)==="undefined"){sexy={}}if(typeof(exports)!=="undefined"){sexy.parser=new (require("./parser").Parser)}else{sexy.parser=new sexy.Parser();exports=sexy}exports.args=function(a,b,c){if(!a.length||typeof(a[0])!=="object"){throw new Error("sexy-args.Parser: first argument must be a reference to the calling scope.")}if(a.length==1){a=[a[0],["function1","object1"],"function1"]}if(typeof(b)=="function"){c=b;b={}}sexy.parser.run({originalContext:a[0],originalArguments:arguments.callee.caller.arguments,argumentDescriptions:a.slice(1),callback:c,defaults:b})};exports.extend=function(e,d,f){exports.args([this,"object1","object2","object3"],{object1:{},object2:{},object3:{}},function(){for(var a in f){if(f.hasOwnProperty(a)){d[a]=f[a]}}for(var a in d){if(d.hasOwnProperty(a)){e[a]=d[a]}}})}})();